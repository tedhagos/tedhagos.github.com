<!DOCTYPE HTML>
<html lang="en">
  <head>
		{% include head.html %}
    <!--
    <script src="../js/jquery-1.11.2.js"></script>
    <script src="../js/jquery.jpanelmenu.js"></script>
    -->
    <link rel="stylesheet" type="text/css" href="/styles/style.css" />
  </head>
  <body>

  <div class="flexbox">
    <div id="tableofcontents">
      {% for category_name in page.categories limit:1 %}
      <h2>{{ category_name }}</h2>
      <ul>
        <!-- <li><a href="/">Home</a></li> -->
        {% assign sortedpages = (site.categories[category_name] | sort: 'title', 'first') %}
        {% for post in sortedpages %}
          {% if post.chapterhead %}
            <li><a href="{{post.url}}" class="chapterhead">{{ post.title }}</a></li>
          {% else %}
            <li><a href="{{post.url}}">{{ post.title }}</a></li>
          {% endif %}
          {% endfor %}
      </ul>
      {% endfor %}
      <h2><a href="/">HOME</a></h2>
    </div>

    <div id="contents">
      <article itemscope itemtype="http://schema.org/Article" >
        <headline><h1>{{ page.title }}</h1></headline>
        <articleBody itempprop="articleBody">
          {{ content }}
        </articleBody>
      </article>



      {% if page.tags.size > 0 %}
      <div id="tagsrelated">

      <!--
      filed under: {{page.tags | array_to_sentence_string }}
      #{{page.tags | join: " #"}} -->
      filed under: #{{page.tags | join: " #"}}
      <br/>
      related docs:
        <ul class="relatedlist">
        {% for post in site.posts %}

            {% assign sameTagCount = 0 %}
            {% assign commonTags = '' %}

            {% for tag in post.tags %}
              {% if page.tags contains tag %}

                {% assign sameTagCount = sameTagCount | plus: 1 %}
                {% capture tagmarkup %} <span class="label label-default">{{ tag }}</span> {% endcapture %}
                {% assign commonTags = commonTags | append: tagmarkup %}

              {% endif %}
            {% endfor %}

            {% if sameTagCount >= 2 %}
              {% if post.title == page.title %}

              {% else %}
              <li>
                <a href="{{ post.url }}">{{ post.title }}</a>
                <!-- {{ commonTags }} -->
              </li>
              {% endif %}

            {% endif %}

        {% endfor %}
      </ul>
      </div>

      <!--
      <div id="tagsrelated">
      filed under: {{page.tags | array_to_sentence_string }}

      {% for t in page.tags %}
        {% if site.tags[t].size > 0 %}
        <ul>
        {% for post in site.tags[t] %}
          {% if post.title == page.title %}

          {% else %}
            <li class=pagetags><a href={{post.url}}>{{post.title}}</a></li>
          {% endif %}
        {% endfor %}
        </ul>
        {% endif %}
      {% endfor %}

      </div>
      -->
      {% endif %}

      <footer>
        {% include footer.html %}
      </footer>

      {% include disqus.html %}

    </div>
  </div>

  </body>
</html>
